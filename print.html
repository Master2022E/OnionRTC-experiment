<!DOCTYPE HTML>
<html lang="en" class="sidebar-visible no-js light">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>OnionRTC</title>
        <meta name="robots" content="noindex" />
        <!-- Custom HTML head -->
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff" />

        <link rel="icon" href="favicon.svg">
        <link rel="shortcut icon" href="favicon.png">
        <link rel="stylesheet" href="css/variables.css">
        <link rel="stylesheet" href="css/general.css">
        <link rel="stylesheet" href="css/chrome.css">
        <link rel="stylesheet" href="css/print.css" media="print">
        <!-- Fonts -->
        <link rel="stylesheet" href="FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="fonts/fonts.css">
        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="highlight.css">
        <link rel="stylesheet" href="tomorrow-night.css">
        <link rel="stylesheet" href="ayu-highlight.css">

        <!-- Custom theme stylesheets -->
    </head>
    <body>
        <!-- Provide site root to javascript -->
        <script type="text/javascript">
            var path_to_root = "";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "light";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script type="text/javascript">
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script type="text/javascript">
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            var html = document.querySelector('html');
            html.classList.remove('no-js')
            html.classList.remove('light')
            html.classList.add(theme);
            html.classList.add('js');
        </script>

        <!-- Hide / unhide sidebar before it is displayed -->
        <script type="text/javascript">
            var html = document.querySelector('html');
            var sidebar = 'hidden';
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            }
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <div class="sidebar-scrollbox">
                <ol class="chapter"><li class="chapter-item expanded "><a href="index.html"><strong aria-hidden="true">1.</strong> Introduction</a></li><li class="chapter-item expanded "><a href="Selenium/index.html"><strong aria-hidden="true">2.</strong> Client Setup</a></li><li class="chapter-item expanded "><a href="Deployment/index.html"><strong aria-hidden="true">3.</strong> Deployment</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="Deployment/Ansible/index.html"><strong aria-hidden="true">3.1.</strong> Ansible</a></li><li class="chapter-item expanded "><a href="Deployment/HostA-Application/index.html"><strong aria-hidden="true">3.2.</strong> Host A - Application server</a></li><li class="chapter-item expanded "><a href="Deployment/HostB-Turn/index.html"><strong aria-hidden="true">3.3.</strong> Host B - Turn server</a></li><li class="chapter-item expanded "><a href="Deployment/HostCD-Router/index.html"><strong aria-hidden="true">3.4.</strong> Host CD - Router</a></li><li class="chapter-item expanded "><a href="Deployment/HostsCD-Clients/index.html"><strong aria-hidden="true">3.5.</strong> Hosts CD - Clients</a></li></ol></li><li class="chapter-item expanded "><a href="CommandAndControl/index.html"><strong aria-hidden="true">4.</strong> Command And Control</a></li><li class="chapter-item expanded "><a href="Dataprocess/index.html"><strong aria-hidden="true">5.</strong> Data Process</a></li></ol>
            </div>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle"></div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky bordered">
                    <div class="left-buttons">
                        <button id="sidebar-toggle" class="icon-button" type="button" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </button>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light (default)</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title">OnionRTC</h1>

                    <div class="right-buttons">
                        <a href="print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>
                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>
                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script type="text/javascript">
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="onionrtc-experiment"><a class="header" href="#onionrtc-experiment">OnionRTC-experiment</a></h1>
<p>This project is a collection of the documentation, tools and scripts used for the experiment done in the DTU master project <em>&quot;Improving anonymity in the use of TURN servers&quot;</em> by Jonas T. Thomsen (s174867) and Christian A. S. Mark (s164833). </p>
<p>The project is about investigating performance and usability of onion routing technologies like Tor, I2P and Lokinet for proxying WebRTC traffic.</p>
<h2 id="general-overview-of-the-experiment"><a class="header" href="#general-overview-of-the-experiment">General overview of the experiment</a></h2>
<p>The experiment is visuallized in the diagram below and are made up of several hosts and components.
The application services are a collection of WebRTC specific infrastructure and central components, which enables hosting a WebRTC application, logging facilities, connection candidate signalling and &quot;Traversal Using Relays around NAT&quot; (TURN). These services are required for the experiment, and are hosted facing the public internet (Links to specific software packages can see in the next chapter with a small description).</p>
<p>Each communication line is explained here:</p>
<ol start="0">
<li>Central Control server communicate with the two client hosts that they should start the experiment. </li>
<li>Central Control server signals to the logging server, that a test is starting with the two clients.</li>
<li>The two clients goes to https://thomsen-it.dk and contacts the web server. A website is served, which the clients use to access a meeting room where they wait.</li>
<li>Both of the clients contacts the signalling server, upgrades the connection to a WebSocket connection and start the discovery and negotiation process. Both clients start the <a href="https://developer.mozilla.org/en-US/docs/Glossary/ICE">ICE</a> (Interactive Connectivity Establishment) protocol to exchange networking options and exchange session descriptors using <a href="https://developer.mozilla.org/en-US/docs/Glossary/SDP">SDP</a> (Session Description Protocol). Both clients are setup to only use TURN over tcp, so they both exchange ICE candidates using the TURN server.</li>
<li>To start sending video and audio data, both clients contacts the TURN server and gets allocated their own TCP communication port. The two clients will now be connected through the TURN server, which acts as a relay and sends data to each client. The data being send is rtp and rtcp, which is wrapped in encrypted tcp/TLS.</li>
<li>Last but not least, all the statistics gathered from the WebRTC clients is sent to the logging server. This include: timestamps, RTT, jitter, packetloss,  and other metrics.</li>
</ol>
<p><img src="overview.drawio.svg" alt="" /></p>
<h2 id="software-used-for-the-experiment"><a class="header" href="#software-used-for-the-experiment">Software used for the experiment</a></h2>
<p>This table contains a component name, software package/reporsitory, a description and a link for getting the software.</p>
<table><thead><tr><th><strong>Component name</strong></th><th><strong>Used for</strong></th><th><strong>software package/reporsitory</strong></th><th><strong>Link(s)</strong></th></tr></thead><tbody>
<tr><td>Web server</td><td>Hosting a website serving HTML and javascript to facilitate/bootstrap a WebRTC session.</td><td>Simple WebRTC</td><td>https://github.com/Master2022E/simple-webrtc</td></tr>
<tr><td>TURN server</td><td>Providing &quot;Traversal Using Relays around NAT&quot; for WebRTC clients behind a strict NAT..</td><td>coturn</td><td>https://github.com/coturn/coturn</td></tr>
<tr><td>Signalling server</td><td>Provides clients of the Web server ability to plan and exchange connection/communication information.</td><td>Signal Server</td><td>https://github.com/Master2022E/SignalServer</td></tr>
<tr><td>Central control server</td><td>Python server that start the experiment by talking to the two client hosts and logging server.</td><td>Python library Fabric</td><td>https://www.fabfile.org/</td></tr>
<tr><td>Logging server</td><td>Provide a central logging endpoint for &quot;Central control server&quot; and WebRTC clients.</td><td>ObserveRTC and MongoDB for database</td><td>https://github.com/ObserveRTC/observer and https://github.com/ObserveRTC/full-stack-examples (for deployment)</td></tr>
<tr><td>Onion routing (Tor)</td><td>Provide an anonymity proxy through the TOR network, which tunnels all HTTPs and WebRTC traffic.</td><td>Tor</td><td>https://support.torproject.org/apt/#tor-deb-repo</td></tr>
<tr><td>Onion routing (Lokinet)</td><td>Provide an anonymity proxy through the Lokinet network, which tunnels all IP traffic through LLARP (Low-Latency Anonymous Routing Protocol).</td><td>Lokinet</td><td>https://docs.oxen.io/products-built-on-oxen/lokinet/guides/linux-gui-install-guide</td></tr>
<tr><td>Host browser</td><td>Browser automation tool that will start a WebRTC session on a client host. It is activated by the Central control server and send its logs to the logging server.</td><td>Selenium</td><td>https://www.selenium.dev/</td></tr>
</tbody></table>
<h2 id="development-details"><a class="header" href="#development-details">Development details</a></h2>
<p>To run the current test run <code>make</code>. this will install the python dependencies and execute the pytest suite. </p>
<blockquote>
<p><strong>NOTE:</strong> The host is currently static, could use <code>thomsen-it.dk</code>, <code>localhost</code> or <code>host.docker.internal</code> depending on the situation <a href="https://stackoverflow.com/questions/31324981/how-to-access-host-port-from-docker-container">reference link</a>. </p>
</blockquote>
<h2 id="experiment-details"><a class="header" href="#experiment-details">Experiment details</a></h2>
<p>Take your TURN.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="running-the-onionrtc-project"><a class="header" href="#running-the-onionrtc-project">Running the OnionRTC project</a></h1>
<h2 id="setting-up-the-machine"><a class="header" href="#setting-up-the-machine">Setting up the machine</a></h2>
<p>The project has been verified, run and tested on a Ubuntu 22.04.1 LTS VM, with 4-8GB RAM and 2-3 CPU cores. </p>
<p>See the scripts in <a href="Selenium/../client_scripts/setup_fake_webcam.sh"><strong>the client script folder</strong></a> to get an idea of what dependencies are needed.</p>
<p>See <a href="Selenium/../Deployment/"><strong>Deployment folder</strong></a> for diagrams, explanations and Ansible scripts.</p>
<h2 id="fake-video-and-audio-stream"><a class="header" href="#fake-video-and-audio-stream">Fake video and audio stream</a></h2>
<p>To simulate a Video and audio call, we create a fake webcam and microphone, which the browser can get as a input stream and use for the WebRTC stream/application. See the scripts in <a href="Selenium/../client_scripts/setup_fake_webcam.sh"><strong>the client script folder</strong></a> for setting it up in ubuntu.</p>
<p>To make sure that the selenium script uses the correct &quot;fake&quot; microphone, we need to make sure that any other microphone is disabled. In the VM running ubuntu it can be done by following the solution <a href="https://askubuntu.com/questions/146654/how-can-i-completely-disable-internal-mic-and-webcam">here</a>, by blacklisting &quot;snd_hda_intel&quot;.</p>
<h2 id="selenium"><a class="header" href="#selenium">Selenium</a></h2>
<p>Install python <a href="Selenium/../requirements.txt">requirements</a> and the geckodriver by following the <a href="Selenium/../client_scripts/onetime_setup_gecko.sh">instructions</a></p>
<h2 id="development"><a class="header" href="#development">Development</a></h2>
<p>When developing in a VM with ssh in vs code, you can enable x11 Forwarding, by running an ssh session in another terminal window by running the command:</p>
<pre><code class="language-shell">ssh -X user@VM
</code></pre>
<h2 id="tor-and-firefox-setup-for-testing"><a class="header" href="#tor-and-firefox-setup-for-testing">Tor and Firefox setup for testing</a></h2>
<p>The client should have installed and setup a running instance of tor.
See the script <a href="Selenium/../client_scripts/setup_tor.sh"><strong>setup_tor.sh</strong></a> for ubuntu instructions</p>
<p>We also need to install firefox, which the geckodriver uses. This should also be in the script.</p>
<p>Now the following command should show the install path of firefox:</p>
<pre><code class="language-shell">$ which firefox
/usr/bin/firefox
</code></pre>
<p>Because of the possible privacy leaks in using STUN and WebRTC, WebRTC has been disabled from the Tor Browser. So the project uses the firefox Browser, and sets the proxy settings to point at the local Tor proxy. A ff addon is needed for quick access to setting the Tor proxy. The <a href="https://addons.mozilla.org/en-US/firefox/addon/tortm-browser-button/">addon</a> simply adds a button for toggling the tor proxy on and off. This can be used when testing manually in the browser.</p>
<p><img src="Selenium/browser_button_Onion.png" alt="" /></p>
<p>When setting up the addon, it will ask for permisson to also run in &quot;Private Window&quot;, press Allow and press Okay.</p>
<p><img src="Selenium/button_onion.png" alt="" /></p>
<p>When the addon has been added, you simply need to press start and wait for the &quot;Connected to 127.0.0.1:9050&quot; message. Now you are connected to the Tor network.</p>
<p><img src="Selenium/button.png" alt="" /></p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="deployment-details"><a class="header" href="#deployment-details">Deployment details</a></h1>
<p>Here is the information for deploying the entire application stack</p>
<p>In the figure below are there an overview of the four servers, and what applications runs where. The &quot;backend&quot; infrastructure runs on host A and B.</p>
<p>The deployment of host A, B, C and D can be seen in the sub folders:</p>
<ul>
<li><a href="Deployment/./HostA-Application/Readme.html">HostA-Application</a></li>
<li><a href="Deployment/./HostB-Turn/Readme.html">HostB-Turn</a></li>
<li><a href="Deployment/./HostCD-Router/Readme.html">HostCD-Router</a></li>
<li><a href="Deployment/./HostsCD-Clients/Readme.html">HostCD-Clients</a></li>
</ul>
<p>The <a href="Deployment/./Deployment.drawio.svg">Deployment</a> diagram describes the server deployment structure that we expect to deploy and run the tests with.</p>
<p><img src="Deployment/Deployment.drawio.svg" alt="Deployment" /></p>
<h2 id="ssh-access-to-the-hosts"><a class="header" href="#ssh-access-to-the-hosts">SSH Access to the hosts</a></h2>
<p>To access the hosts the following ssh commands can be used</p>
<pre><code class="language-shell"># C Clients
ssh -J agpbruger@c.thomsen-it.dk:22022 -X agpbruger@10.3.0.1 -p 22022 -o StrictHostKeyChecking=no
ssh -J agpbruger@c.thomsen-it.dk:22022 -X agpbruger@10.3.0.2 -p 22022 -o StrictHostKeyChecking=no
ssh -J agpbruger@c.thomsen-it.dk:22022 -X agpbruger@10.3.0.3 -p 22022 -o StrictHostKeyChecking=no
ssh -J agpbruger@c.thomsen-it.dk:22022 -X agpbruger@10.3.0.4 -p 22022 -o StrictHostKeyChecking=no
ssh -J agpbruger@c.thomsen-it.dk:22022 -X agpbruger@10.3.0.5 -p 22022 -o StrictHostKeyChecking=no
ssh -J agpbruger@c.thomsen-it.dk:22022 -X agpbruger@10.3.0.6 -p 22022 -o StrictHostKeyChecking=no

# D Clients
ssh -J agpbruger@d.thomsen-it.dk:22022 -X agpbruger@10.4.0.1 -p 22022 -o StrictHostKeyChecking=no
ssh -J agpbruger@d.thomsen-it.dk:22022 -X agpbruger@10.4.0.2 -p 22022 -o StrictHostKeyChecking=no
ssh -J agpbruger@d.thomsen-it.dk:22022 -X agpbruger@10.4.0.3 -p 22022 -o StrictHostKeyChecking=no
ssh -J agpbruger@d.thomsen-it.dk:22022 -X agpbruger@10.4.0.4 -p 22022 -o StrictHostKeyChecking=no
ssh -J agpbruger@d.thomsen-it.dk:22022 -X agpbruger@10.4.0.5 -p 22022 -o StrictHostKeyChecking=no
ssh -J agpbruger@d.thomsen-it.dk:22022 -X agpbruger@10.4.0.6 -p 22022 -o StrictHostKeyChecking=no
</code></pre>
<h2 id="node-exporter"><a class="header" href="#node-exporter">Node Exporter</a></h2>
<p>All hosts runs a node exporter on port 9100. The server A will create connection to the hosts via a ssh port forward, to all the clients in service files. See the setup in the playbooks a<a href="Deployment/./Ansible/playbooks/setupNodeExporter.yaml">setupNodeExporter</a> and <a href="Deployment/./Ansible/playbooks/setupNodeExporterPortForward.yaml">setupNodeExporterPortForward</a></p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="ansible"><a class="header" href="#ansible">Ansible</a></h1>
<p>This document describes how to setup Ansible and the plays which is implemented.</p>
<p>The complete list of servers and names can be found in <a href="Deployment/Ansible/./inventory.yaml">inventory.yaml</a> but can be summarized to:</p>
<ul>
<li>server-[a-d]</li>
<li>clients
<ul>
<li>c_clients
<ul>
<li>c[1-6]</li>
</ul>
</li>
<li>d_clients
<ul>
<li>d[1-6]</li>
</ul>
</li>
</ul>
</li>
</ul>
<p>And can be called by group, list or individually.</p>
<h2 id="installation-and-setup"><a class="header" href="#installation-and-setup">Installation and setup</a></h2>
<p>Read the <a href="https://docs.ansible.com/ansible/latest/getting_started/index.html">getting started documentation</a> or just install with <code>python -m pip install --user ansible</code></p>
<p>If WSL is used it might be required to set the environment variable <code>ANSIBLE_CONFIG</code> to the current directory for it to find the inventory file. Set it with: <code>export ANSIBLE_CONFIG=$PWD</code></p>
<p>There are some plays which requires some updated versions of external collections install them with <code>ansible-galaxy collection install -r</code> Further information can be found in the <a href="https://docs.ansible.com/ansible/latest/collections_guide/collections_installing.html#install-multiple-collections-with-a-requirements-file">documentation</a>.</p>
<blockquote>
<p>NOTE: the requirements installation have not been tested yet.</p>
</blockquote>
<blockquote>
<p>NOTE: All commands is expected to be run from this directory.</p>
</blockquote>
<h2 id="testing-the-setup"><a class="header" href="#testing-the-setup">Testing the setup</a></h2>
<p>Example commands for testing that ansible is working:</p>
<pre><code class="language-shell"># Check the ram usage of the the server A with
ansible server-a -a &quot;free -h&quot;

# Check the hostname of the server
ansible server-c  -m ansible.builtin.setup -a &quot;filter=ansible_hostname&quot;

# Reboot all clients
ansible clients -a &quot;reboot now&quot; -K --become
</code></pre>
<h2 id="ssh-setup"><a class="header" href="#ssh-setup">SSH setup</a></h2>
<p>The client servers are by default accessible through password base authentication, but it can be disabled across all the clients with the following command.</p>
<pre><code class="language-shell">ansible-playbook playbooks/setupSecureSSH.yaml
</code></pre>
<h2 id="ssh-keys"><a class="header" href="#ssh-keys">SSH keys</a></h2>
<p>The key were generated with:</p>
<pre><code class="language-shell">mkdir -p ./playbooks/files/.ssh/

ssh-keygen -f ./playbooks/files/.ssh/id_ecdsa -t ecdsa -b 521 -q -N &quot;&quot; -C Deployment
</code></pre>
<p>The public key is also added to <a href="https://github.com/Master2022E/OnionRTC-experiment/settings/keys">GitHub</a></p>
<p>To send the keys to the remote hosts. (Client hosts C1-C6 and D1-D6) run the command </p>
<pre><code class="language-shell">ansible-playbook playbooks/setupSSHKeys.yaml
</code></pre>
<h2 id="hostname-setup"><a class="header" href="#hostname-setup">Hostname setup</a></h2>
<p>When browsing the servers it can sometimes be hard to know with certainty which server one is using. Therefor we have the hostname's of the servers  defined in the <a href="Deployment/Ansible/./inventory.yaml">inventory list</a> where the hostname can be set for each server.</p>
<p><strong>Beware that it will reboot the host!</strong></p>
<pre><code class="language-shell">ansible-playbook playbooks/setupHostname.yaml -K
</code></pre>
<h2 id="setup-apt-package-dependencies"><a class="header" href="#setup-apt-package-dependencies">Setup APT Package Dependencies</a></h2>
<p>Play which installs the required apt dependencies.</p>
<pre><code class="language-shell">ansible-playbook playbooks/setupPackageDependencies.yaml -K
</code></pre>
<h2 id="setup-big-buck-bunny"><a class="header" href="#setup-big-buck-bunny">Setup Big Buck Bunny</a></h2>
<blockquote>
<p>NOTE: Must be run after the git repository have been fetch, else it will fail or need the force option.</p>
</blockquote>
<pre><code class="language-shell">ansible-playbook playbooks/setupBigBuckbunny.yaml
</code></pre>
<p>After this the movie is accessible in <code>~/OnionRTC-experiment/client_scripts/BigBuckBunny.mp4</code>.</p>
<h2 id="git-pull-and-install-pip-requirements"><a class="header" href="#git-pull-and-install-pip-requirements">Git pull and install Pip requirements</a></h2>
<p>To pull the latest code the ssh keys must be distributed first. Afterwards it is possible to pull the latest version of the main branch. The script will also install the pip requirements defined in the requirements file located in the root folder.</p>
<pre><code class="language-shell">ansible-playbook playbooks/updateGit.yaml
</code></pre>
<p>The code will be located in <code>/home/agpbruger/OnionRTC-experiment/</code></p>
<h2 id="cpu-status-information"><a class="header" href="#cpu-status-information">CPU status information</a></h2>
<p>Play which will display top four cpu processes running and how much CPU it consumes.</p>
<pre><code class="language-shell">ansible-playbook playbooks/readCPU.yaml --limit c1
</code></pre>
<blockquote>
<p>NOTE: The -l or --limit flag is currently required and could be: <code>clients</code>, <code>all</code>, <code>c1</code> or any other host/group.</p>
</blockquote>
<h2 id="get-client-logs"><a class="header" href="#get-client-logs">Get client logs</a></h2>
<p>To allow the developers to more easily locate errors the clients will output logging to a file, which then can be reviewed either on the server or locally pulled with a playbook.</p>
<pre><code class="language-shell">ansible-playbook playbooks/getLogs.yaml --limit &quot;c2,d2&quot;
</code></pre>
<p>The logs will here after be located in <code>./playbooks/logs/c2/debug.log</code> and <code>./playbooks/logs/d2/debug.log</code>.</p>
<h2 id="check-for-video-device"><a class="header" href="#check-for-video-device">Check for video device</a></h2>
<p>To check if the video is running on all hosts:</p>
<pre><code class="language-shell">ansible-playbook playbooks/checkForVideoDevice.yaml
</code></pre>
<h2 id="check-servers-ready"><a class="header" href="#check-servers-ready">Check servers ready</a></h2>
<p>Verify that all clients is ready to run, by checking if the services is started and enabled.</p>
<p>The script is still a work in progress.</p>
<ul>
<li>Tor</li>
<li>Lokinet [TODO]</li>
<li>Webcam [TODO]</li>
</ul>
<pre><code class="language-shell">ansible-playbook playbooks/checkClientsReady.yaml
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="host-a---application-server"><a class="header" href="#host-a---application-server">Host A - Application server</a></h1>
<p>The purpose of the server is to coordinate the tests which will be executed, Store the logs and statuses of the tests and do data processing of the results.</p>
<h2 id="setup"><a class="header" href="#setup">Setup</a></h2>
<p>To control the services are there in each of the sub folder an example <code>.env</code> file which contains the environment variables which is needed for the respective services to run.</p>
<p>When the <code>.env</code> files have been configured, the service can be controlled with the makefile.</p>
<pre><code class="language-shell">$ make

Options include:
  upload  - Uploads the local configuration files
  start   - Starts the services from docker-compose
  stop    - Stops the services from docker-compose
  restart - Stops and starts the services.
  status  - Get the status of the services
  pull    - Pulls the latest images of the services
  logs    - Get the latest 20 logs and follows the next logs
  ssh     - Gets an ssh shell on the server
</code></pre>
<h3 id="caddy"><a class="header" href="#caddy">Caddy</a></h3>
<p><a href="https://caddyserver.com/">Caddy</a> is a reverse proxy that can handle TLS certificates and pass the raw TCP socket data to the respective applications.</p>
<h3 id="webrtc"><a class="header" href="#webrtc">WebRTC</a></h3>
<p>The <a href="https://github.com/Master2022E/simple-webrtc">React application</a> which the clients will use to facilitate a call.</p>
<h3 id="signal"><a class="header" href="#signal">Signal</a></h3>
<p>The <a href="https://github.com/Master2022E/SignalServer">signaling server</a> that coordinates the clients when they join specific rooms.</p>
<h3 id="observertc"><a class="header" href="#observertc">ObserveRTC</a></h3>
<p><a href="https://observertc.org/">ObserveRTC</a> is a backend for receiving statistics of WebRTC streams.</p>
<h3 id="mongodb"><a class="header" href="#mongodb">MongoDB</a></h3>
<p>The <a href="https://www.mongodb.com/">MonogDB</a> database will stores the records saved by ObserveRTC and where we can query data for our notebook scripts.</p>
<p>To access the database from a developer machine one needs to make a local ssh port forward to the server.</p>
<pre><code class="language-shell">ssh -TNL 27017:127.0.0.1:27017 agpbruger@db.thomsen-it.dk -p 22022
</code></pre>
<h3 id="grafana"><a class="header" href="#grafana">Grafana</a></h3>
<p><a href="https://grafana.com/">Grafana</a> in combination with <a href="https://prometheus.io/">Prometheus</a> and <a href="https://github.com/prometheus/node_exporter">Node Exporter</a> could give some easy insights to the load of the server.</p>
<p><img src="Deployment/HostA-Application/./NodeExporterView.png" alt="NodeExporterView" /></p>
<p>To access Grafana run a shell with the command below and then access it on <a href="http://localhost:4000">localhost:4000</a></p>
<pre><code class="language-shell">ssh -TNL 4000:127.0.0.1:4000 agpbruger@a.thomsen-it.dk -p 22022
</code></pre>
<h2 id="initial-setup"><a class="header" href="#initial-setup">Initial setup</a></h2>
<p>To run the applications on the server are the applications <a href="https://www.docker.com/">docker</a> and <a href="https://docs.docker.com/compose/gettingstarted/">docker-compose</a> needed.</p>
<h3 id="firewall"><a class="header" href="#firewall">Firewall</a></h3>
<p>Some applications are not meant to be exposed to the internet. Therefor is the the application ufw used to manage iptables on the server. The following ufw rules is used</p>
<pre><code class="language-shell">sudo ufw allow 22022 comment 'Allow SSH connections'
sudo ufw allow 443 comment 'HTTPS connections'
sudo ufw allow 80 comment 'HTTP redirected to HTTPS'
sudo ufw allow 3000 comment 'Signaling websocket server'

</code></pre>
<p>This gives the configuration like shown below.</p>
<pre><code class="language-shell">sudo ufw status
Status: active

To                         Action      From
--                         ------      ----
22022                      ALLOW       Anywhere                   # Allow SSH connections
80                         ALLOW       Anywhere                   # HTTP redirected to HTTPS
443                        ALLOW       Anywhere                   # HTTPS connections
3000                       ALLOW       Anywhere                   # Signaling websocket server
22022 (v6)                 ALLOW       Anywhere (v6)              # Allow SSH connections
80 (v6)                    ALLOW       Anywhere (v6)              # HTTP redirected to HTTPS
443 (v6)                   ALLOW       Anywhere (v6)              # HTTPS connections
3000 (v6)                  ALLOW       Anywhere (v6)              # Signaling websocket server
</code></pre>
<blockquote>
<p>FIXME: Add a option to allow machines from Host C and Host D to access the mongodb server. <a href="https://www.digitalocean.com/community/tutorials/ufw-essentials-common-firewall-rules-and-commands">link</a> with example of how to allow specific ips and ports access.</p>
</blockquote>
<div style="break-before: page; page-break-before: always;"></div><h1 id="host-b---turn-server"><a class="header" href="#host-b---turn-server">Host B - Turn server</a></h1>
<p>The purpose of the server is to host a Turn server that clients can use as a middel-man when having a online call.</p>
<h2 id="setup-1"><a class="header" href="#setup-1">Setup</a></h2>
<p>The folder <a href="Deployment/HostB-Turn/./coturn/">coturn</a> has an example configuration file. When the configuration file files have been configured, the service can be controlled with the makefile.</p>
<pre><code class="language-shell">$ make

Options include:
  upload  - Uploads the local configuration files
  start   - Starts the services from docker-compose
  stop    - Stops the services from docker-compose
  restart - Stops and starts the services.
  status  - Get the status of the services
  pull    - Pulls the latest images of the services
  logs    - Get the latest 20 logs and follows the next logs
  ssh     - Gets an ssh shell on the server
</code></pre>
<h2 id="services"><a class="header" href="#services">Services</a></h2>
<h3 id="coturn"><a class="header" href="#coturn">coturn</a></h3>
<p><a href="https://github.com/coturn/coturn">coturn</a> is an open source implementation of a TURN server.</p>
<h3 id="node-exporter-1"><a class="header" href="#node-exporter-1">Node Exporter</a></h3>
<blockquote>
<p>TODO and might not happen. Will maybe be a weekend project.
<a href="https://github.com/prometheus/node_exporter">Node Exporter</a> could give some easy insights to the load of the server. would be accessible on Host A.</p>
</blockquote>
<h2 id="initial-setup-1"><a class="header" href="#initial-setup-1">Initial setup</a></h2>
<p>To run the application on the server are the applications <a href="https://www.docker.com/">docker</a> and <a href="https://docs.docker.com/compose/gettingstarted/">docker-compose</a> needed.</p>
<h3 id="firewall-1"><a class="header" href="#firewall-1">Firewall</a></h3>
<p>The turn service needs a lot of different ports opened to run the following rules is used</p>
<pre><code class="language-shell">sudo ufw allow 22022 comment 'Allow SSH connections'
sudo ufw allow 3478 comment 'Turn'
sudo ufw allow 49152:65535/udp comment 'Turn'

</code></pre>
<p>This gives the configuration like shown below.</p>
<pre><code class="language-shell">sudo ufw status
Status: active

To                         Action      From
--                         ------      ----
22022                      ALLOW       Anywhere                   # Allow SSH connections
3478                       ALLOW       Anywhere                   # Turn
49152:65535/udp            ALLOW       Anywhere                   # Turn
22022 (v6)                 ALLOW       Anywhere (v6)              # Allow SSH connections
3478 (v6)                  ALLOW       Anywhere (v6)              # Turn
49152:65535/udp (v6)       ALLOW       Anywhere (v6)              # Turn
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="host-c-and-d---router"><a class="header" href="#host-c-and-d---router">Host C and D - Router</a></h1>
<p>The purpose of the two routers is to act as a gateway for their respective clients C1-6 and D1-6, so they can access the internet. Furthermore, the routers are responsible for port forwarding SSH connection to the clients so we can communicate and control the clients.</p>
<p><img src="Deployment/HostCD-Router/HostCD-deployment.drawio.svg" alt="Deployment" /></p>
<h2 id="firewall-setup"><a class="header" href="#firewall-setup">Firewall Setup</a></h2>
<ol>
<li>For setting up the router, the following steps are needed:
We start by adding an ufw rule to allow the ssh connection to the router (We use port 22022).</li>
</ol>
<pre><code class="language-shell">sudo ufw allow 22022 comment 'Allow SSH connections'
</code></pre>
<p>This gives the configuration like shown below.</p>
<pre><code class="language-shell">sudo ufw status
Status: active

To                         Action      From
--                         ------      ----            
22022                      ALLOW IN    Anywhere                       
22022 (v6)                 ALLOW IN    Anywhere (v6) 
</code></pre>
<ol start="2">
<li>Change forwarding policy of packets on the host:</li>
</ol>
<pre><code class="language-shell">sudo nano /etc/default/ufw
# Change the line `DEFAULT_FORWARD_POLICY=&quot;DROP&quot;` to `DEFAULT_FORWARD_POLICY=&quot;ACCEPT&quot;`
</code></pre>
<ol start="3">
<li>Allow Ipv4 forwarding of packets on the host:</li>
</ol>
<pre><code class="language-shell">sudo nano  /etc/ufw/sysctl.conf 
# Uncomment this line `net/ipv4/ip_forward=1` 
</code></pre>
<ol start="4">
<li>Change UFW rules to do ssh port forwarding to each host:</li>
</ol>
<pre><code class="language-shell">sudo nano  /etc/ufw/before.rules 

# nat Table rules
*nat
:POSTROUTING ACCEPT [0:0]

# Forward traffic from eth1 through eth0.
-A POSTROUTING -s 10.x.0.0/24 -o eth0 -j MASQUERADE
-A PREROUTING -i eth0 -d 130.225.170.x -p tcp --dport 22001 -j  DNAT --to-destination 10.x.0.1:22022
-A PREROUTING -i eth0 -d 130.225.170.x -p tcp --dport 22002 -j  DNAT --to-destination 10.x.0.2:22022
-A PREROUTING -i eth0 -d 130.225.170.x -p tcp --dport 22003 -j  DNAT --to-destination 10.x.0.3:22022
-A PREROUTING -i eth0 -d 130.225.170.x -p tcp --dport 22004 -j  DNAT --to-destination 10.x.0.4:22022
-A PREROUTING -i eth0 -d 130.225.170.x -p tcp --dport 22005 -j  DNAT --to-destination 10.x.0.5:22022
-A PREROUTING -i eth0 -d 130.225.170.x -p tcp --dport 22006 -j  DNAT --to-destination 10.x.0.6:22022
# don't delete the 'COMMIT' line or these nat table rules won't be processed
COMMIT
</code></pre>
<ol start="5">
<li>Restart UFW</li>
</ol>
<pre><code class="language-shell">sudo ufw disable &amp;&amp; sudo ufw enable
</code></pre>
<ol start="6">
<li>Verify by sshing into the client using the port forwarded port specificed in the before.rules file.</li>
</ol>
<pre><code class="language-shell">ssh user@ip -p 22001
</code></pre>
<ol start="7">
<li>The forwarding and port forwarding rules should now be setup.</li>
</ol>
<div style="break-before: page; page-break-before: always;"></div><h1 id="host-c-and-d---client"><a class="header" href="#host-c-and-d---client">Host C and D - Client</a></h1>
<p>The purpose of the client is to act as a client for the application. The client is responsible for connecting to the TURN server and the application server. Furthermore, the client is responsible for sending and receiving media. They are controlled by the &quot;C&amp;C&quot; server over ssh and needs internet access.</p>
<p><img src="Deployment/HostsCD-Clients/../HostCD-Router/HostCD-deployment.drawio.svg" alt="Deployment" /></p>
<h2 id="setup-2"><a class="header" href="#setup-2">Setup</a></h2>
<p>Each client has a specific enviroment setup, which is described in the <a href="Deployment/HostsCD-Clients/../../client_scripts/">client scripts folder</a> as small scripts.</p>
<p>The client setup can be divided into two parts. The first part is responsible for setting up the client with a fake webcam running a test video with audio. The other part consist of the client environment variables, setting up the anonimity network connection and lastly the firefox browser setup, used by Selenium.</p>
<h3 id="webcam-setup"><a class="header" href="#webcam-setup">Webcam setup</a></h3>
<blockquote>
<p><strong>NOTE:</strong> TODO</p>
</blockquote>
<h3 id="client-environment-variables"><a class="header" href="#client-environment-variables">Client environment variables</a></h3>
<blockquote>
<p><strong>NOTE:</strong> TODO</p>
</blockquote>
<h3 id="anonimity-network-connection-setup"><a class="header" href="#anonimity-network-connection-setup">Anonimity network connection setup</a></h3>
<blockquote>
<p><strong>NOTE:</strong> TODO</p>
</blockquote>
<h3 id="firefox-browser-setup"><a class="header" href="#firefox-browser-setup">Firefox browser setup</a></h3>
<blockquote>
<p><strong>NOTE:</strong> TODO</p>
</blockquote>
<h2 id="firewall-setup-1"><a class="header" href="#firewall-setup-1">Firewall Setup</a></h2>
<p>The clients just need to have the ssh port open to be able to connect to the router. This is done by adding the following rule to the ufw firewall.</p>
<pre><code class="language-shell">sudo ufw allow 22022 comment 'Allow SSH connections'
</code></pre>
<p>This gives the configuration like shown below.</p>
<pre><code class="language-shell">sudo ufw status
Status: active

To                         Action      From
--                         ------      ----            
22022                      ALLOW IN    Anywhere                       
22022 (v6)                 ALLOW IN    Anywhere (v6) 
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="command-and-control"><a class="header" href="#command-and-control">Command and Control</a></h1>
<p>The program will be in charge of staring the tests between clients.</p>
<h2 id="setup-3"><a class="header" href="#setup-3">Setup</a></h2>
<p>The program will run on server A, see the <a href="CommandAndControl/../Deployment/">Deployment diagram</a>.</p>
<p>To allow local development with connections to the Mongo database, it is needed to create a local port forward.</p>
<pre><code class="language-shell">ssh -fTNL 27017:localhost:27017 agpbruger@db.thomsen-it.dk -p 22022
# or 
ssh -L 27017:127.0.0.1:27017 agpbruger@db.thomsen-it.dk -p 22022
</code></pre>
<h2 id="build"><a class="header" href="#build">Build</a></h2>
<pre><code class="language-shell">docker-compose build
</code></pre>
<h2 id="start-the-service"><a class="header" href="#start-the-service">Start the service</a></h2>
<pre><code class="language-shell">docker-compose up -d
</code></pre>
<h2 id="release"><a class="header" href="#release">Release</a></h2>
<p>To release the image it is possible to publish to docker hub with the following command and it will update the tag of latest image and the verison number.</p>
<pre><code class="language-shell">make publish username=foo version=v0.0.0
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="data-processing"><a class="header" href="#data-processing">Data processing</a></h1>
<p>This Readme describes how to get started with the data processing and shows the results of the experiment.</p>
<h2 id="data-access"><a class="header" href="#data-access">Data Access</a></h2>
<p>To get access to the data please read the <a href="Dataprocess/./DataAccess.html">DataAccess</a> document.</p>
<h2 id="scenario-list"><a class="header" href="#scenario-list">Scenario list</a></h2>
<p>To shorten some of the naming, the plots follow the abbreviation scheme the individual clients (c1-c6 and d1-d6) is configured to the specific setup.</p>
<table><thead><tr><th>Networking type</th><th>abbreviation</th></tr></thead><tbody>
<tr><td>Normal</td><td>Norm</td></tr>
<tr><td>Tor (Normal)</td><td>TorN</td></tr>
<tr><td>Tor (Europe)</td><td>TorE</td></tr>
<tr><td>Tor (Scandinavia)</td><td>TorS</td></tr>
<tr><td>Lokinet</td><td>Loki</td></tr>
</tbody></table>
<p>The following tabels are the different scenarios which is being tested. Here c1 referees to the client c1, which can be seen in the <a href="Dataprocess/../Deployment/Readme.html">Deployment</a> documentation.</p>
<p>One to one</p>
<table><thead><tr><th>Name</th><th>Setup</th></tr></thead><tbody>
<tr><td>01 Norm-Norm</td><td><code>Alice, Norm(c1)</code> → <code>Turn</code> ← <code>Norm(d1), Bob</code></td></tr>
<tr><td>02 TorN-TorN</td><td><code>Alice, TorN(c2)</code> → <code>Turn</code> ← <code>TorN(d2), Bob</code></td></tr>
<tr><td>03 TorE-TorE</td><td><code>Alice, TorE(c3)</code> → <code>Turn</code> ← <code>TorE(d3), Bob</code></td></tr>
<tr><td>04 TorS-TorS</td><td><code>Alice, TorS(c4)</code> → <code>Turn</code> ← <code>TorS(d4), Bob</code></td></tr>
<tr><td>05 Loki-Loki</td><td><code>Alice, Loki(c6)</code> → <code>Turn</code> ← <code>Loki(d6), Bob</code></td></tr>
</tbody></table>
<p>Normal to Anonymized in pairs</p>
<table><thead><tr><th>Name</th><th>Setup</th></tr></thead><tbody>
<tr><td>06 Norm-TorN</td><td><code>Alice, Norm(c1)</code> → <code>Turn</code> ← <code>TorN(d2), Bob</code></td></tr>
<tr><td>07 TorN-Norm</td><td><code>Alice, TorN(c2)</code> → <code>Turn</code> ← <code>Norm(d1), Bob</code></td></tr>
<tr><td>08 Norm-TorE</td><td><code>Alice, Norm(c1)</code> → <code>Turn</code> ← <code>TorE(d3), Bob</code></td></tr>
<tr><td>09 TorE-Norm</td><td><code>Alice, TorE(c3)</code> → <code>Turn</code> ← <code>Norm(d1), Bob</code></td></tr>
<tr><td>10 Norm-TorS</td><td><code>Alice, Norm(c1)</code> → <code>Turn</code> ← <code>TorS(d4), Bob</code></td></tr>
<tr><td>11 TorS-Norm</td><td><code>Alice, TorS(c4)</code> → <code>Turn</code> ← <code>Norm(d1), Bob</code></td></tr>
<tr><td>12 Norm-Loki</td><td><code>Alice, Norm(c1)</code> → <code>Turn</code> ← <code>Loki(d6), Bob</code></td></tr>
<tr><td>13 Loki-Norm</td><td><code>Alice, Loki(c6)</code> → <code>Turn</code> ← <code>Norm(d1), Bob</code></td></tr>
</tbody></table>
<p>Tor to Tor in pairs</p>
<table><thead><tr><th>Name</th><th>Setup</th></tr></thead><tbody>
<tr><td>14 TorN-TorE</td><td><code>Alice, TorN(c2)</code> → <code>Turn</code> ← <code>TorE(d3), Bob</code></td></tr>
<tr><td>15 TorE-TorN</td><td><code>Alice, TorE(c3)</code> → <code>Turn</code> ← <code>TorN(d2), Bob</code></td></tr>
<tr><td>16 TorN-TorS</td><td><code>Alice, TorN(c2)</code> → <code>Turn</code> ← <code>TorS(d4), Bob</code></td></tr>
<tr><td>17 TorS-TorN</td><td><code>Alice, TorS(c4)</code> → <code>Turn</code> ← <code>TorN(d2), Bob</code></td></tr>
<tr><td>18 TorE-TorS</td><td><code>Alice, TorE(c3)</code> → <code>Turn</code> ← <code>TorS(d4), Bob</code></td></tr>
<tr><td>19 TorS-TorE</td><td><code>Alice, TorS(c4)</code> → <code>Turn</code> ← <code>TorE(d3), Bob</code></td></tr>
</tbody></table>
<p>For each test call, there will be created logs that goes to the Mongo database. In the <code>calls</code> table the following will be present: which scenario is started, the outcome of the call and when each client detected the session started and ended. The ObserveRTC logs will go to the <code>reports</code> table, where the WebRTC specific data is located.</p>
<hr />
<h2 id="preprocessing"><a class="header" href="#preprocessing">Preprocessing</a></h2>
<p>To get data ready for processing, run the <a href="Dataprocess/./ExtractRawData.ipynb">ExtractRawData</a> notebook. This will connect to the MongoDB and gather the call stats, do som basic data transformation and save it to CSV files, which will be overwritten each time the script is called. The outcome will be the following files:</p>
<ul>
<li><code>output_folder/uniqueCallsAndOutcomes.csv</code></li>
<li><code>output_folder/rawReport/c1-Normal.csv</code></li>
<li><code>output_folder/rawReport/c2-TorNormal.csv</code></li>
<li><code>output_folder/rawReport/c3-TorEurope.csv</code></li>
<li><code>output_folder/rawReport/c4-TorScandinavia.csv</code></li>
<li><code>output_folder/rawReport/c6-Lokinet.csv</code></li>
<li><code>output_folder/rawReport/d1-Normal.csv</code></li>
<li><code>output_folder/rawReport/d2-TorNormal.csv</code></li>
<li><code>output_folder/rawReport/d3-TorEurope.csv</code></li>
<li><code>output_folder/rawReport/d4-TorScandinavia.csv</code></li>
<li><code>output_folder/rawReport/d6-Lokinet.csv</code></li>
</ul>
<p>Next, run the <a href="Dataprocess/./SuccessfulCallsStartAndEnd.ipynb">SuccessfulCallsStartAndEnd</a> notebook, this will for the scenarios <code>1, 8, 9, 10</code> and <code>11</code> find the start and end timestamps of all the successful calls. The outcome will be the file:</p>
<ul>
<li><code>output_folder/SuccessfulCallsStartAndEnd.csv</code>.</li>
</ul>
<p>Next, to get the bandwidth usage data, run the <a href="Dataprocess/./BandwidthDataExtractionTransmit.ipynb">BandwidthDataExtractionTransmit</a> and the <a href="Dataprocess/./BandwidthDataExtractionReceive.ipynb">BandwidthDataExtractionReceive</a> notebooks. The outcome will be the files:</p>
<ul>
<li><code>output_folder/SuccessfulCallsUsedTransmitBandwidth.csv</code></li>
<li><code>output_folder/SuccessfulCallsUsedTransmitBandwidthValues.csv</code></li>
<li><code>output_folder/SuccessfulCallsUsedReceiveBandwidth.csv</code></li>
<li><code>output_folder/SuccessfulCallsUsedReceiveBandwidthValues.csv</code></li>
</ul>
<p>Now all preprocessing is complete.</p>
<hr />
<h2 id="results"><a class="header" href="#results">Results</a></h2>
<p>This section will show the results of the experiment that was gathered during the project. Also each sub section will describe which notebooks have been used to generate the specific plots.</p>
<h3 id="success-or-fail-overview"><a class="header" href="#success-or-fail-overview">Success or fail overview</a></h3>
<p>The total success and failure rate of the calls can be seen in the <a href="Dataprocess/./SuccessOrFail.ipynb">SuccessOrFail</a> notebook.</p>
<p>And provides the following graph:</p>
<p><img src="Dataprocess/./output_folder/SuccessOrFail.svg" alt="Success or fail" /></p>
<h3 id="success-rate-over-time"><a class="header" href="#success-rate-over-time">Success rate over time</a></h3>
<p>The success rate over time can be seen in the <a href="Dataprocess/./SuccessRateOverTime.ipynb">SuccessRateOverTime</a> notebook.</p>
<p>And provides the following graph:</p>
<p><img src="Dataprocess/./output_folder/SuccessRateOverTime.svg" alt="Success rate over time" /></p>
<p><img src="Dataprocess/./output_folder/SuccessRateOverTimeHigh.svg" alt="High performing Success rate over time" /></p>
<p><img src="Dataprocess/./output_folder/SuccessRateOverTimeLow.svg" alt="Low performing Success rate over time" /></p>
<p>Note: Client C4 started to have a technical error from the 2023-01-15. That is the reason for 4 scenarios completely failing from that time and forward.</p>
<p><img src="Dataprocess/./output_folder/SuccessRateOverTimeCloseUp.svg" alt="Success rate over time (Close up)" /></p>
<h3 id="rtt-in-successful-calls"><a class="header" href="#rtt-in-successful-calls">RTT in successful calls</a></h3>
<p>Plot for RTT of video and audio on successful calls. Created in the <a href="Dataprocess/./RoundTripTimeBoxPlot.ipynb">RoundTripTimeBoxPlot</a> notebook.</p>
<p><img src="Dataprocess/./output_folder/BoxPlotRttVideo.svg" alt="RTT for video in successful calls" /></p>
<p><img src="Dataprocess/./output_folder/BoxPlotRttVideoLogScale.svg" alt="RTT for video in successful calls on a logarithmic scale" /></p>
<p><img src="Dataprocess/./output_folder/BoxPlotRttAudio.svg" alt="RTT for audio in successful calls" /></p>
<p><img src="Dataprocess/./output_folder/BoxPlotRttAudioLogScale.svg" alt="RTT for audio in successful calls on a logarithmic scale" /></p>
<p><img src="Dataprocess/./output_folder/BoxPlotRttVideoCloseUpLogScale.svg" alt="RTT for video in successful calls (Close up)" /></p>
<p><img src="Dataprocess/./output_folder/BoxPlotRttAudioCloseUpLogScale.svg" alt="RTT for audio in successful calls (Close up)" /></p>
<h3 id="jitter-in-successful-calls"><a class="header" href="#jitter-in-successful-calls">Jitter in successful calls</a></h3>
<p>Plot for Jitter of video and audio on successful calls. Created in the <a href="Dataprocess/./JitterBoxPlot.ipynb">JitterBoxPlot</a> notebook.</p>
<p><img src="Dataprocess/./output_folder/BoxPlotJitterVideo.svg" alt="Jitter for video in successful calls" /></p>
<p><img src="Dataprocess/./output_folder/BoxPlotJitterAudio.svg" alt="Jitter for audio in successful calls" /></p>
<p><img src="Dataprocess/./output_folder/BoxPlotJitterVideoCloseUp.svg" alt="Jitter for Video in successful calls (Close up)" /></p>
<p><img src="Dataprocess/./output_folder/BoxPlotJitterAudioCloseUp.svg" alt="Jitter for audio in successful calls (Close up)" /></p>
<h3 id="average-jitter-buffer-delay"><a class="header" href="#average-jitter-buffer-delay">Average jitter buffer delay</a></h3>
<p>Plot for Average jitter of video and audio on successful calls. Created in the <a href="Dataprocess/./JitterBufferDelayBoxPlot.ipynb">JitterBufferDelayBoxPlot</a> notebook</p>
<p><img src="Dataprocess/./output_folder/BoxPlotAvgJitterBufferDelayVideo.svg" alt="Average video jitter buffer delay" /></p>
<p><img src="Dataprocess/./output_folder/BoxPlotAvgJitterBufferDelayAudio.svg" alt="Average audio jitter buffer delay" /></p>
<p><img src="Dataprocess/./output_folder/BoxPlotAvgJitterBufferDelayVideoCloseUp.svg" alt="Average video jitter buffer delay (Close up)" /></p>
<p><img src="Dataprocess/./output_folder/BoxPlotAvgJitterBufferDelayAudioCloseUp.svg" alt="Average audio jitter buffer delay (Close up)" /></p>
<h3 id="bandwidth-used"><a class="header" href="#bandwidth-used">Bandwidth used</a></h3>
<p>Plot for the total bandwidth used during successful calls. Created in the <a href="Dataprocess/./BandwidthUsedPlots.ipynb">BandwidthUsedPlots</a> notebook.</p>
<p><img src="Dataprocess/./output_folder/BoxPlotUsedBandwidthTransmit.svg" alt="Average bandwidth transmit during successful calls" /></p>
<p><img src="Dataprocess/./output_folder/BoxPlotUsedBandwidthReceive.svg" alt="Average bandwidth receive during successful calls" /></p>
<p><img src="Dataprocess/./output_folder/BoxPlotUsedBandwidth.svg" alt="Average bandwidth used during successful calls" /></p>
<p><img src="Dataprocess/./output_folder/BoxPlotUsedBandwidthWithThreshold.svg" alt="Average bandwidth used during successful calls with threshold values" /></p>
<p><img src="Dataprocess/./output_folder/BoxPlotUsedBandwidthWithThresholdZoom.svg" alt="Average bandwidth used during successful calls with threshold values (Zoom)" /></p>
<p><img src="Dataprocess/./output_folder/BoxPlotUsedBandwidthWithThresholdYoutubeAndTeams.svg" alt="Average bandwidth used during successful calls with threshold values (Youtube and Teams)" /></p>
<h2 id="validation"><a class="header" href="#validation">Validation</a></h2>
<p>To validate the results it can be related to the metrics from the material in <a href="Dataprocess/./external_material/Readme.html">external material</a>.</p>
<p>Graph of throughput in the Tor network during the experiment. <a href="https://metrics.torproject.org/onionperf-throughput.html?start=2022-12-23&amp;end=2023-01-24&amp;server=public">Source</a></p>
<p><img src="Dataprocess/./external_material/onionperf-throughput-public-2022-12-23-2023-01-24.png" alt="Graph of throughput in the Tor network during the experiment" /></p>
<p>Graph of latencies in the Tor network during the experiment. <a href="https://metrics.torproject.org/onionperf-latencies.html?start=2022-12-23&amp;end=2023-01-24&amp;server=public">Source</a></p>
<p><img src="Dataprocess/./external_material/onionperf-latencies-public-2022-12-23-2023-01-24.png" alt="Graph of latencies in the Tor network during the experiment" /></p>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
            </nav>

        </div>

        <script type="text/javascript">
            window.playground_copyable = true;
        </script>
        <script src="elasticlunr.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="mark.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="searcher.js" type="text/javascript" charset="utf-8"></script>
        <script src="clipboard.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="highlight.js" type="text/javascript" charset="utf-8"></script>
        <script src="book.js" type="text/javascript" charset="utf-8"></script>

        <!-- Custom JS scripts -->
        <script type="text/javascript">
        window.addEventListener('load', function() {
            window.setTimeout(window.print, 100);
        });
        </script>
    </body>
</html>
