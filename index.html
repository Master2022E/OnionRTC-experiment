<!DOCTYPE HTML>
<html lang="en" class="sidebar-visible no-js light">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>Introduction - OnionRTC</title>
        <!-- Custom HTML head -->
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff" />

        <link rel="icon" href="favicon.svg">
        <link rel="shortcut icon" href="favicon.png">
        <link rel="stylesheet" href="css/variables.css">
        <link rel="stylesheet" href="css/general.css">
        <link rel="stylesheet" href="css/chrome.css">
        <link rel="stylesheet" href="css/print.css" media="print">
        <!-- Fonts -->
        <link rel="stylesheet" href="FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="fonts/fonts.css">
        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="highlight.css">
        <link rel="stylesheet" href="tomorrow-night.css">
        <link rel="stylesheet" href="ayu-highlight.css">

        <!-- Custom theme stylesheets -->
    </head>
    <body>
        <!-- Provide site root to javascript -->
        <script type="text/javascript">
            var path_to_root = "";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "light";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script type="text/javascript">
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script type="text/javascript">
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            var html = document.querySelector('html');
            html.classList.remove('no-js')
            html.classList.remove('light')
            html.classList.add(theme);
            html.classList.add('js');
        </script>

        <!-- Hide / unhide sidebar before it is displayed -->
        <script type="text/javascript">
            var html = document.querySelector('html');
            var sidebar = 'hidden';
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            }
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <div class="sidebar-scrollbox">
                <ol class="chapter"><li class="chapter-item expanded "><a href="index.html" class="active"><strong aria-hidden="true">1.</strong> Introduction</a></li><li class="chapter-item expanded "><a href="Selenium/index.html"><strong aria-hidden="true">2.</strong> Client Setup</a></li><li class="chapter-item expanded "><a href="Deployment/index.html"><strong aria-hidden="true">3.</strong> Deployment</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="Deployment/Ansible/index.html"><strong aria-hidden="true">3.1.</strong> Ansible</a></li><li class="chapter-item expanded "><a href="Deployment/HostA-Application/index.html"><strong aria-hidden="true">3.2.</strong> Host A - Application server</a></li><li class="chapter-item expanded "><a href="Deployment/HostB-Turn/index.html"><strong aria-hidden="true">3.3.</strong> Host B - Turn server</a></li><li class="chapter-item expanded "><a href="Deployment/HostCD-Router/index.html"><strong aria-hidden="true">3.4.</strong> Host CD - Router</a></li><li class="chapter-item expanded "><a href="Deployment/HostsCD-Clients/index.html"><strong aria-hidden="true">3.5.</strong> Hosts CD - Clients</a></li></ol></li><li class="chapter-item expanded "><a href="CommandAndControl/index.html"><strong aria-hidden="true">4.</strong> Command And Control</a></li><li class="chapter-item expanded "><a href="Dataprocess/index.html"><strong aria-hidden="true">5.</strong> Data Process</a></li></ol>
            </div>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle"></div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky bordered">
                    <div class="left-buttons">
                        <button id="sidebar-toggle" class="icon-button" type="button" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </button>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light (default)</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title">OnionRTC</h1>

                    <div class="right-buttons">
                        <a href="print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>
                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>
                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script type="text/javascript">
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="onionrtc-experiment"><a class="header" href="#onionrtc-experiment">OnionRTC-experiment</a></h1>
<p>This project is a collection of the documentation, tools and scripts used for the experiment done in the DTU master project <em>&quot;Improving anonymity in the use of TURN servers&quot;</em> by Jonas T. Thomsen (s174867) and Christian A. S. Mark (s164833). </p>
<p>The project is about investigating performance and usability of onion routing technologies like Tor, I2P and Lokinet for proxying WebRTC traffic.</p>
<h2 id="general-overview-of-the-experiment"><a class="header" href="#general-overview-of-the-experiment">General overview of the experiment</a></h2>
<p>The experiment is visuallized in the diagram below and are made up of several hosts and components.
The application services are a collection of WebRTC specific infrastructure and central components, which enables hosting a WebRTC application, logging facilities, connection candidate signalling and &quot;Traversal Using Relays around NAT&quot; (TURN). These services are required for the experiment, and are hosted facing the public internet (Links to specific software packages can see in the next chapter with a small description).</p>
<p>Each communication line is explained here:</p>
<ol start="0">
<li>Central Control server communicate with the two client hosts that they should start the experiment. </li>
<li>Central Control server signals to the logging server, that a test is starting with the two clients.</li>
<li>The two clients goes to https://thomsen-it.dk and contacts the web server. A website is served, which the clients use to access a meeting room where they wait.</li>
<li>Both of the clients contacts the signalling server, upgrades the connection to a WebSocket connection and start the discovery and negotiation process. Both clients start the <a href="https://developer.mozilla.org/en-US/docs/Glossary/ICE">ICE</a> (Interactive Connectivity Establishment) protocol to exchange networking options and exchange session descriptors using <a href="https://developer.mozilla.org/en-US/docs/Glossary/SDP">SDP</a> (Session Description Protocol). Both clients are setup to only use TURN over tcp, so they both exchange ICE candidates using the TURN server.</li>
<li>To start sending video and audio data, both clients contacts the TURN server and gets allocated their own TCP communication port. The two clients will now be connected through the TURN server, which acts as a relay and sends data to each client. The data being send is rtp and rtcp, which is wrapped in encrypted tcp/TLS.</li>
<li>Last but not least, all the statistics gathered from the WebRTC clients is sent to the logging server. This include: timestamps, RTT, jitter, packetloss,  and other metrics.</li>
</ol>
<p><img src="overview.drawio.svg" alt="" /></p>
<h2 id="software-used-for-the-experiment"><a class="header" href="#software-used-for-the-experiment">Software used for the experiment</a></h2>
<p>This table contains a component name, software package/reporsitory, a description and a link for getting the software.</p>
<table><thead><tr><th><strong>Component name</strong></th><th><strong>Used for</strong></th><th><strong>software package/reporsitory</strong></th><th><strong>Link(s)</strong></th></tr></thead><tbody>
<tr><td>Web server</td><td>Hosting a website serving HTML and javascript to facilitate/bootstrap a WebRTC session.</td><td>Simple WebRTC</td><td>https://github.com/Master2022E/simple-webrtc</td></tr>
<tr><td>TURN server</td><td>Providing &quot;Traversal Using Relays around NAT&quot; for WebRTC clients behind a strict NAT..</td><td>coturn</td><td>https://github.com/coturn/coturn</td></tr>
<tr><td>Signalling server</td><td>Provides clients of the Web server ability to plan and exchange connection/communication information.</td><td>Signal Server</td><td>https://github.com/Master2022E/SignalServer</td></tr>
<tr><td>Central control server</td><td>Python server that start the experiment by talking to the two client hosts and logging server.</td><td>Python library Fabric</td><td>https://www.fabfile.org/</td></tr>
<tr><td>Logging server</td><td>Provide a central logging endpoint for &quot;Central control server&quot; and WebRTC clients.</td><td>ObserveRTC and MongoDB for database</td><td>https://github.com/ObserveRTC/observer and https://github.com/ObserveRTC/full-stack-examples (for deployment)</td></tr>
<tr><td>Onion routing (Tor)</td><td>Provide an anonymity proxy through the TOR network, which tunnels all HTTPs and WebRTC traffic.</td><td>Tor</td><td>https://support.torproject.org/apt/#tor-deb-repo</td></tr>
<tr><td>Onion routing (Lokinet)</td><td>Provide an anonymity proxy through the Lokinet network, which tunnels all IP traffic through LLARP (Low-Latency Anonymous Routing Protocol).</td><td>Lokinet</td><td>https://docs.oxen.io/products-built-on-oxen/lokinet/guides/linux-gui-install-guide</td></tr>
<tr><td>Host browser</td><td>Browser automation tool that will start a WebRTC session on a client host. It is activated by the Central control server and send its logs to the logging server.</td><td>Selenium</td><td>https://www.selenium.dev/</td></tr>
</tbody></table>
<h2 id="development-details"><a class="header" href="#development-details">Development details</a></h2>
<p>To run the current test run <code>make</code>. this will install the python dependencies and execute the pytest suite. </p>
<blockquote>
<p><strong>NOTE:</strong> The host is currently static, could use <code>thomsen-it.dk</code>, <code>localhost</code> or <code>host.docker.internal</code> depending on the situation <a href="https://stackoverflow.com/questions/31324981/how-to-access-host-port-from-docker-container">reference link</a>. </p>
</blockquote>
<h2 id="experiment-details"><a class="header" href="#experiment-details">Experiment details</a></h2>
<p>Take your TURN.</p>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                            <a rel="next" href="Selenium/index.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>
                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                    <a rel="next" href="Selenium/index.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
            </nav>

        </div>

        <script type="text/javascript">
            window.playground_copyable = true;
        </script>
        <script src="elasticlunr.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="mark.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="searcher.js" type="text/javascript" charset="utf-8"></script>
        <script src="clipboard.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="highlight.js" type="text/javascript" charset="utf-8"></script>
        <script src="book.js" type="text/javascript" charset="utf-8"></script>

        <!-- Custom JS scripts -->
    </body>
</html>
